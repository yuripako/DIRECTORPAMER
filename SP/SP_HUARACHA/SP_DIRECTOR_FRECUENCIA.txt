CREATE DEFINER=`developer2021`@`%` PROCEDURE `pamervirtual`.`SP_DIRECTOR_FRECUENCIA`(
	intSalon int,
	varTipo varchar(20)
)
BEGIN
	select count(a1.codalumno) as total,
	count(IF(tb.acuer IS NULL, 1, NULL)) as cero, count(IF(tb.acuer = 1, 1, NULL)) as uno,
	count(IF(tb.acuer = 2, 1, NULL)) as dos, count(IF(tb.acuer = 3, 1, NULL)) as tres,
	count(IF(tb.acuer = 4, 1, NULL)) as cuatro, count(IF(tb.acuer >= 5, 1, NULL)) as cinco,
	ati.grupodes
	from alumnos a1 
	left join datos_basicos db on a1.codalumno = db.codfox 
	left join alumnos_tipopag ati on a1.codtipopag =ati.codtipopag 
	left join salones s1 on s1.codsalones = a1.codsalon 
	left join ccostos cc on cc.codccostos = a1.codccosto and s1.codccosto = cc.codccostos 
	left join (
		select a.codalumno, ao.alumno_cod,cc.codlinea, s.codciclo , s.codsalones,count(ao.acuerdo_id) as acuer
		from alumnos a
		left join acuerdos_orientacion ao on ao.alumno_cod = a.codalumno
		left join salones s on s.codsalones = ao.salon
		left join ccostos cc on cc.codccostos = a.codccosto
		where ao.acuerdo_relacion = 1 and s.codsalones = intSalon
		group by ao.alumno_cod
	) as tb on tb.codsalones = s1.codsalones and a1.codalumno = tb.alumno_cod
	where s1.codsalones = intSalon and if(varTipo='TODOS',ati.grupodes!=varTipo, ati.grupodes=varTipo)
	and db.swactivo = 1 and db.sweliminado =0 and a1.swretirado	= 0	and a1.swanulado = 0;
END